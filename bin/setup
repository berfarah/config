#!/usr/bin/env ruby

# Install git-crypt if it's missing
unless shell "which git-crypt"
  puts "Instaling git-crypt"
  shell "brew install git-crypt"
end

POSSIBLE_KEYS = %w(development.key staging.key)

keys = Dir[*POSSIBLE_KEYS]

if keys.empty?
  STDERR.puts "You need one of these keys to use this repo:"
  STDERR.puts POSSIBLE_KEYS
  exit 1
end

# Set git-crypt up with the available keys
keys.each { |key| shell "git-crypt unlock #{key}" }
